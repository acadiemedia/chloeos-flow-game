
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prototype 11: The Complete Deck</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background-color: #121212;
      color: #e0e0e0;
      margin: 0;
      overflow: hidden;
      display: flex;
    }
    #sidebar {
      width: 250px;
      height: 100vh;
      background-color: #1e1e1e;
      padding: 20px;
      overflow-y: auto;
    }
    #canvas {
      flex-grow: 1;
    }
    .card {
      width: 100px;
      height: 100px;
      background-color: #2a2a2e;
      border: 1px solid #444;
      border-radius: 10px;
      margin-bottom: 10px;
      cursor: grab;
      text-align: center;
      padding: 10px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    .node {
      cursor: move;
    }
    .node-rect {
      fill: #2a2a2e;
      stroke: #bb86fc;
      stroke-width: 2px;
      rx: 10;
      ry: 10;
    }
    .node-text {
      fill: #e0e0e0;
      font-size: 14px;
      text-anchor: middle;
    }
  </style>
</head>
<body>
  <div id="sidebar"></div>
  <svg id="canvas"></svg>
  <script>
    const deck = {
      'Input/Output': [
        { name: 'UserInput', inputs: [], outputs: ['text'] },
        { name: 'FileInput', inputs: [], outputs: ['text'] },
        { name: 'WebInput', inputs: [], outputs: ['text'] },
        { name: 'DisplayOutput', inputs: ['text'], outputs: [] },
        { name: 'FileOutput', inputs: ['text'], outputs: [] },
      ],
      'Text Generation': [
        { name: 'Summarize', inputs: ['text'], outputs: ['text'] },
        { name: 'GenerateArticle', inputs: ['text'], outputs: ['text'] },
        { name: 'GenerateCode', inputs: ['text'], outputs: ['text'] },
      ],
      'Text Transformation': [
        { name: 'Translate', inputs: ['text'], outputs: ['text'] },
        { name: 'ChangeStyle', inputs: ['text'], outputs: ['text'] },
        { name: 'CorrectGrammar', inputs: ['text'], outputs: ['text'] },
      ],
      'Text Analysis': [
        { name: 'SentimentAnalysis', inputs: ['text'], outputs: ['sentiment'] },
        { name: 'ClassifyIntent', inputs: ['text'], outputs: ['intent'] },
      ],
      'Logic & Control': [
        { name: 'If/Else', inputs: ['boolean', 'any'], outputs: ['any'] },
        { name: 'Loop', inputs: ['list'], outputs: ['list'] },
      ],
      'External Tools': [
        { name: 'WebSearch', inputs: ['text'], outputs: ['text'] },
        { name: 'APICall', inputs: ['url'], outputs: ['response'] },
      ]
    };

    const sidebar = d3.select('#sidebar');
    Object.entries(deck).forEach(([category, cards]) => {
      sidebar.append('h3').text(category);
      cards.forEach(card => {
        sidebar.append('div').attr('class', 'card').text(card.name)
          .call(d3.drag().on('start', (event) => {
            const [x, y] = d3.pointer(event, svg.node());
            const newNode = { ...card, id: Date.now(), x: x, y: y };
            nodes.push(newNode);
            update();
          }));
      });
    });

    let nodes = [];
    const svg = d3.select('#canvas');
    const g = svg.append('g');
    svg.call(d3.zoom().on('zoom', (event) => g.attr('transform', event.transform)));

    function update() {
      const node = g.selectAll('.node').data(nodes, d => d.id);
      const nodeEnter = node.enter().append('g').attr('class', 'node')
        .attr('transform', d => `translate(${d.x},${d.y})`)
        .call(d3.drag().on('drag', (event, d) => {
          d.x = event.x; d.y = event.y;
          update();
        }));
      
      nodeEnter.append('rect').attr('class', 'node-rect').attr('width', 100).attr('height', 100);
      nodeEnter.append('text').attr('class', 'node-text').attr('dy', 55).attr('dx', 50).text(d => d.name);

      node.attr('transform', d => `translate(${d.x},${d.y})`);
      node.exit().remove();
    }

    update();
  </script>
</body>
</html>
